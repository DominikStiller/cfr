
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Proxy Composites &#8212; cfr  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Climate" href="../ug-climate.html" />
    <link rel="prev" title="Get the nearest climate for proxies" href="proxy-get-nearest-climate.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/favicon.ico" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">cfr  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User Guide
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ug-installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../ug-proxy.html">
   Proxy
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="proxy-io.html">
     Input/Output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="proxy-ops.html">
     Basic Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="proxy-viz.html">
     Visualizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="proxy-analysis.html">
     Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="proxy-get-nearest-climate.html">
     Get the nearest climate for proxies
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Proxy Composites
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ug-climate.html">
   Climate
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="climate-io.html">
     Input/Output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="climate-ops.html">
     Basic Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="climate-viz.html">
     Visualizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="climate-analysis.html">
     Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ug-psm.html">
   PSM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-linear.html">
     Univariate linear regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-bilinear.html">
     Bivariate linear regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-ice-d18O.html">
     PSM for ice core d18O
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-lake-VarveThickness.html">
     PSM for lake varve thickness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-coral-SrCa.html">
     PSM for coral Sr/Ca
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-coral-d18O.html">
     PSM for coral d18O
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-tree-TRW.html">
     PSM for tree TRW (VS-Lite)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-tree-seasonality.html">
     Detecting the seasonality of the trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="psm-tree-memory.html">
     Detecting the biological memory in the trees
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ug-lmr.html">
   LMR
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="lmr-basics.html">
     Basic workflows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lmr-cfg.html">
     Run the job based on the configurations in a YAML file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lmr-mc.html">
     Monte-Carlo iterations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lmr-post.html">
     Post-processing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ug-graphem.html">
   GraphEM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="graphem-quickstart.html">
     GraphEM: basic workflow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="graphem-ppe-pages2k.html">
     A Pseudoproxy Experiment with GraphEM and pseudoPAGES2k
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ug-api.html">
   API Reference
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/fzhu2e/cfr"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/fzhu2e/cfr/issues/new?title=Issue%20on%20page%20%2Fnotebooks/proxy-composites.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/fzhu2e/cfr/edit/master/notebooks/proxy-composites.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/proxy-composites.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Load-the-PAGES2k-network-stored-in-a-pandas-DataFrame">
   Load the PAGES2k network stored in a pandas
   <code class="docutils literal notranslate">
    <span class="pre">
     DataFrame
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Create-a-ProxyDatabase-and-load-from-the-pandas-DataFrame">
   Create a
   <code class="docutils literal notranslate">
    <span class="pre">
     ProxyDatabase
    </span>
   </code>
   and load from the pandas
   <code class="docutils literal notranslate">
    <span class="pre">
     DataFrame
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Create-composites-for-each-proxy-type">
   Create composites for each proxy type
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Without-calibration-to-an-instrumental-target">
     Without calibration to an instrumental target
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#With-calibration-to-an-instrumental-target">
     With calibration to an instrumental target
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#The-composite-of-ice-core-records">
   The composite of ice core records
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Proxy Composites</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Load-the-PAGES2k-network-stored-in-a-pandas-DataFrame">
   Load the PAGES2k network stored in a pandas
   <code class="docutils literal notranslate">
    <span class="pre">
     DataFrame
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Create-a-ProxyDatabase-and-load-from-the-pandas-DataFrame">
   Create a
   <code class="docutils literal notranslate">
    <span class="pre">
     ProxyDatabase
    </span>
   </code>
   and load from the pandas
   <code class="docutils literal notranslate">
    <span class="pre">
     DataFrame
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Create-composites-for-each-proxy-type">
   Create composites for each proxy type
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Without-calibration-to-an-instrumental-target">
     Without calibration to an instrumental target
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#With-calibration-to-an-instrumental-target">
     With calibration to an instrumental target
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#The-composite-of-ice-core-records">
   The composite of ice core records
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Proxy-Composites">
<h1>Proxy Composites<a class="headerlink" href="#Proxy-Composites" title="Permalink to this headline">#</a></h1>
<p>In this tutorial, we introduce how to generate composites of proxies with <code class="docutils literal notranslate"><span class="pre">cfr</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">cfr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<section id="Load-the-PAGES2k-network-stored-in-a-pandas-DataFrame">
<h2>Load the PAGES2k network stored in a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#Load-the-PAGES2k-network-stored-in-a-pandas-DataFrame" title="Permalink to this headline">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;./data/pages2k_dataset.pkl&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;paleoData_pages2kID&#39;, &#39;dataSetName&#39;, &#39;archiveType&#39;, &#39;geo_meanElev&#39;,
       &#39;geo_meanLat&#39;, &#39;geo_meanLon&#39;, &#39;year&#39;, &#39;yearUnits&#39;,
       &#39;paleoData_variableName&#39;, &#39;paleoData_units&#39;, &#39;paleoData_values&#39;,
       &#39;paleoData_proxy&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
</section>
<section id="Create-a-ProxyDatabase-and-load-from-the-pandas-DataFrame">
<h2>Create a <code class="docutils literal notranslate"><span class="pre">ProxyDatabase</span></code> and load from the pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#Create-a-ProxyDatabase-and-load-from-the-pandas-DataFrame" title="Permalink to this headline">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdb</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ProxyDatabase</span><span class="p">()</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pdb</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_proxy-composites_6_0.png" src="../_images/notebooks_proxy-composites_6_0.png" />
</div>
</div>
</section>
<section id="Create-composites-for-each-proxy-type">
<h2>Create composites for each proxy type<a class="headerlink" href="#Create-composites-for-each-proxy-type" title="Permalink to this headline">#</a></h2>
<p>We take corals as an example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdb_corals</span> <span class="o">=</span> <span class="n">pdb</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;ptype&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="s1">&#39;coral&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_proxy-composites_9_0.png" src="../_images/notebooks_proxy-composites_9_0.png" />
</div>
</div>
<section id="Without-calibration-to-an-instrumental-target">
<h3>Without calibration to an instrumental target<a class="headerlink" href="#Without-calibration-to-an-instrumental-target" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdb_corals</span><span class="o">.</span><span class="n">make_composite</span><span class="p">(</span><span class="n">bin_width</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Analyzing ProxyRecord:   0%|          | 0/104 [00:00&lt;?, ?it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord: 100%|██████████| 104/104 [00:00&lt;00:00, 1561.96it/s]
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/pandas/core/apply.py:867: RuntimeWarning: Mean of empty slice
  results[i] = self.f(v)
Bootstrapping:   0%|          | 0/110 [00:00&lt;?, ?it/s]/Users/fzhu/Github/cfr/cfr/utils.py:127: RuntimeWarning: Mean of empty slice
  stats[i] = stat_func(samples[rand_ind])
Bootstrapping: 100%|██████████| 110/110 [00:01&lt;00:00, 65.35it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">plot_composite</span><span class="p">(</span><span class="n">left_ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_proxy-composites_12_0.png" src="../_images/notebooks_proxy-composites_12_0.png" />
</div>
</div>
</section>
<section id="With-calibration-to-an-instrumental-target">
<h3>With calibration to an instrumental target<a class="headerlink" href="#With-calibration-to-an-instrumental-target" title="Permalink to this headline">#</a></h3>
<p>We load instrumental temperature observations as a target for scaling the proxy values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check the variable and dimension names</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./data/HadCRUT.5.0.1.0.analysis.anomalies.ensemble_mean.nc&#39;</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (time: 2052, latitude: 36, longitude: 72, bnds: 2)
Coordinates:
  * time              (time) datetime64[ns] 1850-01-16T12:00:00 ... 2020-12-1...
  * latitude          (latitude) float64 -87.5 -82.5 -77.5 ... 77.5 82.5 87.5
  * longitude         (longitude) float64 -177.5 -172.5 -167.5 ... 172.5 177.5
    realization       int64 100
Dimensions without coordinates: bnds
Data variables:
    tas_mean          (time, latitude, longitude) float64 ...
    time_bnds         (time, bnds) datetime64[ns] 1850-01-01 ... 2021-01-01
    latitude_bnds     (latitude, bnds) float64 -90.0 -85.0 -85.0 ... 85.0 90.0
    longitude_bnds    (longitude, bnds) float64 -180.0 -175.0 ... 175.0 180.0
    realization_bnds  (bnds) int64 1 200
Attributes:
    comment:      2m air temperature over land blended with sea water tempera...
    history:
    institution:  Met Office Hadley Centre / Climatic Research Unit, Universi...
    licence:      HadCRUT5 is licensed under the Open Government Licence v3.0...
    reference:    C. P. Morice, J. J. Kennedy, N. A. Rayner, J. P. Winn, E. H...
    source:       CRUTEM.5.0.1.0 HadSST.4.0.0.0
    title:        HadCRUT.5.0.1.0 blended land air temperature and sea-surfac...
    version:      HadCRUT.5.0.1.0
    Conventions:  CF-1.7</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1c36edfb-9142-4f94-9829-be4fa0f2007b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1c36edfb-9142-4f94-9829-be4fa0f2007b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2052</li><li><span class='xr-has-index'>latitude</span>: 36</li><li><span class='xr-has-index'>longitude</span>: 72</li><li><span>bnds</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8a1e214e-f5ae-4220-97a6-3da8dd9960c7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8a1e214e-f5ae-4220-97a6-3da8dd9960c7' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-16T12:00:00 ... 2020-12-...</div><input id='attrs-4a9b53bf-5e7a-410d-9b42-7c29ffdd6a6e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a9b53bf-5e7a-410d-9b42-7c29ffdd6a6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9635afd5-7254-4b34-b559-a216723a0b20' class='xr-var-data-in' type='checkbox'><label for='data-9635afd5-7254-4b34-b559-a216723a0b20' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-16T12:00:00.000000000&#x27;, &#x27;1850-02-15T00:00:00.000000000&#x27;,
       &#x27;1850-03-16T12:00:00.000000000&#x27;, ..., &#x27;2020-10-16T12:00:00.000000000&#x27;,
       &#x27;2020-11-16T00:00:00.000000000&#x27;, &#x27;2020-12-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.5 -82.5 -77.5 ... 82.5 87.5</div><input id='attrs-49543831-b5ed-4a3b-aaef-3bd23650c74b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-49543831-b5ed-4a3b-aaef-3bd23650c74b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-722b7958-33a2-4e4d-b07d-5693e8d18adc' class='xr-var-data-in' type='checkbox'><label for='data-722b7958-33a2-4e4d-b07d-5693e8d18adc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>latitude_bnds</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-177.5 -172.5 ... 172.5 177.5</div><input id='attrs-ea38fae2-44b2-48d9-994a-9f56e3a61cf5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ea38fae2-44b2-48d9-994a-9f56e3a61cf5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e220edb6-1d46-408b-a49e-3d8238c33b32' class='xr-var-data-in' type='checkbox'><label for='data-e220edb6-1d46-408b-a49e-3d8238c33b32' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>longitude_bnds</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>realization</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1f33ae08-93cd-4c5e-9ed5-be7d7dec3e1d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1f33ae08-93cd-4c5e-9ed5-be7d7dec3e1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e9629c3-ad1d-4e3b-a0bf-730f9bee86a6' class='xr-var-data-in' type='checkbox'><label for='data-3e9629c3-ad1d-4e3b-a0bf-730f9bee86a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>realization_bnds</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(100)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b4e5ac5b-5010-4957-8d53-b2e1bcf00cb6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b4e5ac5b-5010-4957-8d53-b2e1bcf00cb6' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas_mean</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4c79aead-a215-4442-826d-0960f4dc1b2f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4c79aead-a215-4442-826d-0960f4dc1b2f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb4bf56f-41fb-42e2-a77e-df0f6799c5ab' class='xr-var-data-in' type='checkbox'><label for='data-fb4bf56f-41fb-42e2-a77e-df0f6799c5ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>blended air_temperature_anomaly over land with sea_water_temperature_anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>area: mean (interval: 5.0 degrees_north 5.0 degrees_east) time: mean (interval: 1 month) realization: mean</dd></dl></div><div class='xr-var-data'><pre>[5318784 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-94abca98-3459-44b3-a3ed-d319ca0190b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-94abca98-3459-44b3-a3ed-d319ca0190b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-56f75e96-e4f7-4b42-87c1-cae7f611d9b4' class='xr-var-data-in' type='checkbox'><label for='data-56f75e96-e4f7-4b42-87c1-cae7f611d9b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[&#x27;1850-01-01T00:00:00.000000000&#x27;, &#x27;1850-02-01T00:00:00.000000000&#x27;],
       [&#x27;1850-02-01T00:00:00.000000000&#x27;, &#x27;1850-03-01T00:00:00.000000000&#x27;],
       [&#x27;1850-03-01T00:00:00.000000000&#x27;, &#x27;1850-04-01T00:00:00.000000000&#x27;],
       ...,
       [&#x27;2020-10-01T00:00:00.000000000&#x27;, &#x27;2020-11-01T00:00:00.000000000&#x27;],
       [&#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
       [&#x27;2020-12-01T00:00:00.000000000&#x27;, &#x27;2021-01-01T00:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude_bnds</span></div><div class='xr-var-dims'>(latitude, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ecc70bba-2e04-4531-b5e3-d95c9fec242a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ecc70bba-2e04-4531-b5e3-d95c9fec242a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74102e3c-f8f8-417e-b0d0-1494ae3ad1c2' class='xr-var-data-in' type='checkbox'><label for='data-74102e3c-f8f8-417e-b0d0-1494ae3ad1c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-90., -85.],
       [-85., -80.],
       [-80., -75.],
       [-75., -70.],
       [-70., -65.],
       [-65., -60.],
       [-60., -55.],
       [-55., -50.],
       [-50., -45.],
       [-45., -40.],
       [-40., -35.],
       [-35., -30.],
       [-30., -25.],
       [-25., -20.],
       [-20., -15.],
       [-15., -10.],
       [-10.,  -5.],
       [ -5.,   0.],
       [  0.,   5.],
       [  5.,  10.],
       [ 10.,  15.],
       [ 15.,  20.],
       [ 20.,  25.],
       [ 25.,  30.],
       [ 30.,  35.],
       [ 35.,  40.],
       [ 40.,  45.],
       [ 45.,  50.],
       [ 50.,  55.],
       [ 55.,  60.],
       [ 60.,  65.],
       [ 65.,  70.],
       [ 70.,  75.],
       [ 75.,  80.],
       [ 80.,  85.],
       [ 85.,  90.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude_bnds</span></div><div class='xr-var-dims'>(longitude, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a306bd1a-89ba-4ed2-ba80-41e66a71d2b2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a306bd1a-89ba-4ed2-ba80-41e66a71d2b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af3a21f9-31f4-4cf0-b822-9524ac2431a2' class='xr-var-data-in' type='checkbox'><label for='data-af3a21f9-31f4-4cf0-b822-9524ac2431a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-180., -175.],
       [-175., -170.],
       [-170., -165.],
       [-165., -160.],
       [-160., -155.],
       [-155., -150.],
       [-150., -145.],
       [-145., -140.],
       [-140., -135.],
       [-135., -130.],
       [-130., -125.],
       [-125., -120.],
       [-120., -115.],
       [-115., -110.],
       [-110., -105.],
       [-105., -100.],
       [-100.,  -95.],
       [ -95.,  -90.],
       [ -90.,  -85.],
       [ -85.,  -80.],
       [ -80.,  -75.],
       [ -75.,  -70.],
       [ -70.,  -65.],
       [ -65.,  -60.],
       [ -60.,  -55.],
       [ -55.,  -50.],
       [ -50.,  -45.],
       [ -45.,  -40.],
       [ -40.,  -35.],
       [ -35.,  -30.],
       [ -30.,  -25.],
       [ -25.,  -20.],
       [ -20.,  -15.],
       [ -15.,  -10.],
       [ -10.,   -5.],
       [  -5.,    0.],
       [   0.,    5.],
       [   5.,   10.],
       [  10.,   15.],
       [  15.,   20.],
       [  20.,   25.],
       [  25.,   30.],
       [  30.,   35.],
       [  35.,   40.],
       [  40.,   45.],
       [  45.,   50.],
       [  50.,   55.],
       [  55.,   60.],
       [  60.,   65.],
       [  65.,   70.],
       [  70.,   75.],
       [  75.,   80.],
       [  80.,   85.],
       [  85.,   90.],
       [  90.,   95.],
       [  95.,  100.],
       [ 100.,  105.],
       [ 105.,  110.],
       [ 110.,  115.],
       [ 115.,  120.],
       [ 120.,  125.],
       [ 125.,  130.],
       [ 130.,  135.],
       [ 135.,  140.],
       [ 140.,  145.],
       [ 145.,  150.],
       [ 150.,  155.],
       [ 155.,  160.],
       [ 160.,  165.],
       [ 165.,  170.],
       [ 170.,  175.],
       [ 175.,  180.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>realization_bnds</span></div><div class='xr-var-dims'>(bnds)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-eeb12dc6-1fc5-41b2-97c9-3523c6006067' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eeb12dc6-1fc5-41b2-97c9-3523c6006067' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be637992-a483-4929-bae9-8979db974d46' class='xr-var-data-in' type='checkbox'><label for='data-be637992-a483-4929-bae9-8979db974d46' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1, 200])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7fec87ce-541f-4a5f-be33-77755be17b4e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7fec87ce-541f-4a5f-be33-77755be17b4e' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>2m air temperature over land blended with sea water temperature at a depth of 20cm expressed as monthly anomalies relative to 1961-1990 climatology.</dd><dt><span>history :</span></dt><dd></dd><dt><span>institution :</span></dt><dd>Met Office Hadley Centre / Climatic Research Unit, University of East Anglia</dd><dt><span>licence :</span></dt><dd>HadCRUT5 is licensed under the Open Government Licence v3.0 except where otherwise stated. To view this licence, visit https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3</dd><dt><span>reference :</span></dt><dd>C. P. Morice, J. J. Kennedy, N. A. Rayner, J. P. Winn, E. Hogan, R. E. Killick, R. J. H. Dunn, T. J. Osborn, P. D. Jones and I. R. Simpson (2020), An updated assessment of near-surface temperature change from 1850: the HadCRUT5 dataset, Submitted to J. Geophys. Res.</dd><dt><span>source :</span></dt><dd>CRUTEM.5.0.1.0 HadSST.4.0.0.0</dd><dt><span>title :</span></dt><dd>HadCRUT.5.0.1.0 blended land air temperature and sea-surface temperature anomaly data set</dd><dt><span>version :</span></dt><dd>HadCRUT.5.0.1.0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ClimateField</span><span class="p">()</span><span class="o">.</span><span class="n">load_nc</span><span class="p">(</span>
    <span class="s1">&#39;./data/HadCRUT.5.0.1.0.analysis.anomalies.ensemble_mean.nc&#39;</span><span class="p">,</span>
    <span class="n">vn</span><span class="o">=</span><span class="s1">&#39;tas_mean&#39;</span><span class="p">,</span> <span class="n">lat_name</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">lon_name</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;tas&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">it</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_proxy-composites_16_0.png" src="../_images/notebooks_proxy-composites_16_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdb_corals</span><span class="o">.</span><span class="n">make_composite</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">bin_width</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Analyzing ProxyRecord:  14%|█▍        | 15/104 [00:00&lt;00:01, 48.97it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord:  35%|███▍      | 36/104 [00:00&lt;00:01, 60.52it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord: 100%|██████████| 104/104 [00:01&lt;00:00, 57.72it/s]
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/pandas/core/apply.py:867: RuntimeWarning: Mean of empty slice
  results[i] = self.f(v)
Bootstrapping:   0%|          | 0/110 [00:00&lt;?, ?it/s]/Users/fzhu/Github/cfr/cfr/utils.py:127: RuntimeWarning: Mean of empty slice
  stats[i] = stat_func(samples[rand_ind])
Bootstrapping: 100%|██████████| 110/110 [00:01&lt;00:00, 64.64it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the composite infomation:</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;proxy_comp:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;proxy_comp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;proxy_num:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;proxy_num&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df_obs:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;df_obs&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;slope:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;intercept:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
proxy_comp:
 Float64Index([ 925.0,  935.0,  945.0,  955.0,  965.0,  975.0,  985.0,  995.0,
              1005.0, 1015.0,
              ...
              1925.0, 1935.0, 1945.0, 1955.0, 1965.0, 1975.0, 1985.0, 1995.0,
              2005.0, 2015.0],
             dtype=&#39;float64&#39;, length=110)
proxy_num:
 [  1.   1.   1.   1.   1.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.   0.   0.   0.   1.   1.   1.   1.   1.   1.
   1.   1.   1.   0.   0.   0.   0.   0.   0.   0.   0.   1.   1.   1.
   2.   3.   3.   3.   5.   5.   5.   5.   5.   5.   5.   5.   5.   4.
   4.   4.   4.   5.   5.   5.   5.   6.   7.   7.   7.   7.   8.   8.
   9.  11.  12.  13.  13.  13.  13.  13.  16.  15.  17.  17.  17.  21.
  21.  22.  29.  34.  38.  38.  41.  43.  48.  51.  56.  62.  71.  84.
  93.  93.  98. 100. 101. 101.  99.  99.  98.  88.  26.   8.]
df_obs:
          Ocn_065   Ocn_075   Ocn_078   Ocn_167   Ocn_091   Ocn_093   Ocn_096  \
1855.0       NaN       NaN       NaN -0.205589       NaN       NaN       NaN
1865.0       NaN -0.411357       NaN       NaN       NaN       NaN       NaN
1875.0       NaN       NaN       NaN       NaN       NaN       NaN       NaN
1885.0       NaN -0.293635       NaN -0.343136       NaN       NaN       NaN
1895.0       NaN -0.263564       NaN -0.357457 -0.017921 -0.017921       NaN
1905.0       NaN -0.295720 -0.477541 -0.336948 -0.499484 -0.499484       NaN
1915.0 -0.409030 -0.353642 -0.404239 -0.303997 -0.385642 -0.385642       NaN
1925.0 -0.326301 -0.215696 -0.231768 -0.243615 -0.203692 -0.203692 -0.295812
1935.0 -0.219341 -0.230150 -0.178130 -0.255383 -0.181764 -0.181764       NaN
1945.0  0.050894  0.067905  0.041306 -0.134179 -0.115930 -0.115930       NaN
1955.0  0.165398 -0.150163 -0.095860  0.028338 -0.069165 -0.069165 -0.056503
1965.0 -0.020170 -0.232314 -0.147204 -0.099432 -0.175826 -0.175826 -0.215575
1975.0  0.073728  0.003847 -0.015949 -0.021495  0.127029  0.127029  0.194500
1985.0 -0.013573  0.173390  0.118942  0.151294  0.117000  0.117000  0.062425
1995.0  0.078321  0.336906  0.236005  0.367082  0.125404  0.125404  0.114688
2005.0  0.524196  0.536344  0.339151  0.470025  0.545965  0.545965  0.489652
2015.0  0.594656  0.831119  0.576251  0.745144  0.560249  0.560249  0.492643
2025.0  0.721700  0.598944  1.014098  0.902159  0.786555  0.786555  0.606045

         Ocn_086   Ocn_101   Ocn_070  ...   Ocn_090   Ocn_119   Ocn_109  \
1855.0       NaN       NaN       NaN  ...       NaN       NaN       NaN
1865.0       NaN       NaN       NaN  ...       NaN       NaN       NaN
1875.0       NaN       NaN       NaN  ...       NaN       NaN       NaN
1885.0 -0.156775       NaN       NaN  ...       NaN       NaN       NaN
1895.0 -0.307884       NaN       NaN  ...       NaN       NaN -0.017921
1905.0 -0.297574       NaN       NaN  ...       NaN       NaN -0.499484
1915.0 -0.258138 -0.441400 -0.475493  ... -0.282402       NaN -0.385642
1925.0 -0.026011 -0.340216 -0.261950  ... -0.157599 -0.254639 -0.203692
1935.0  0.118868 -0.342152 -0.157990  ... -0.046964 -0.233436 -0.181764
1945.0 -0.142440 -0.016425  0.060123  ... -0.142528       NaN -0.115930
1955.0  0.033336  0.007120 -0.041880  ... -0.087915 -0.211131 -0.069165
1965.0 -0.105926 -0.221945 -0.045443  ... -0.176294 -0.034219 -0.175826
1975.0 -0.037005  0.085508 -0.030004  ... -0.044368 -0.184235  0.127029
1985.0  0.080488  0.091893  0.050631  ...  0.149136  0.134095  0.117000
1995.0  0.111560  0.228314  0.082739  ...  0.226947  0.194516  0.125404
2005.0  0.230500  0.345507  0.559948  ...  0.463342  0.311364  0.545965
2015.0  0.516225  0.439639  0.541845  ...  0.614403  0.492854  0.560249
2025.0  0.682405  0.737460  0.646357  ...  1.018375  0.681892  0.786555

         Ocn_097   Ocn_159   Ocn_087   Ocn_153   Ocn_169   Ocn_071   Ocn_072
1855.0       NaN       NaN       NaN       NaN       NaN       NaN       NaN
1865.0       NaN       NaN       NaN       NaN       NaN       NaN       NaN
1875.0       NaN       NaN       NaN       NaN       NaN       NaN       NaN
1885.0       NaN       NaN       NaN -0.650625       NaN       NaN       NaN
1895.0       NaN       NaN       NaN -0.448504       NaN       NaN       NaN
1905.0       NaN       NaN       NaN -0.590030       NaN       NaN       NaN
1915.0 -0.296292       NaN       NaN -0.428159       NaN       NaN       NaN
1925.0 -0.154915 -0.254639       NaN -0.389576 -0.254639 -0.239705 -0.239705
1935.0 -0.034458 -0.233436       NaN -0.284132 -0.233436 -0.186442 -0.186442
1945.0 -0.157033       NaN       NaN -0.023910       NaN       NaN       NaN
1955.0 -0.120586 -0.211131       NaN -0.269210 -0.211131 -0.184902 -0.184902
1965.0 -0.196732 -0.034219 -0.042081 -0.183740 -0.034219 -0.027577 -0.027577
1975.0 -0.043380 -0.184235 -0.123280 -0.019263 -0.184235 -0.148386 -0.148386
1985.0  0.154048  0.134095  0.150367  0.164937  0.134095  0.099159  0.099159
1995.0  0.145717  0.194516  0.432526  0.244548  0.194516  0.105454  0.105454
2005.0  0.398888  0.311364  0.556371  0.227715  0.311364  0.456239  0.456239
2015.0  0.561737  0.492854  0.708399  0.569747  0.492854  0.495962  0.495962
2025.0  0.891832  0.681892  0.744754  0.744560  0.681892  0.622959  0.622959

[18 rows x 104 columns]
slope:
 -0.7047097538255472
intercept:
 -0.2321439372057043
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pdb_corals</span><span class="o">.</span><span class="n">plot_composite</span><span class="p">()</span>
<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">cfr</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;./figs/coral_composites.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_proxy-composites_19_0.png" src="../_images/notebooks_proxy-composites_19_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Figure saved at: &#34;figs/coral_composites.pdf&#34;
</pre></div></div>
</div>
</section>
</section>
<section id="The-composite-of-ice-core-records">
<h2>The composite of ice core records<a class="headerlink" href="#The-composite-of-ice-core-records" title="Permalink to this headline">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdb_ice</span> <span class="o">=</span> <span class="n">pdb</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;ptype&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="s1">&#39;ice&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pdb_ice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_proxy-composites_21_0.png" src="../_images/notebooks_proxy-composites_21_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdb_ice</span><span class="o">.</span><span class="n">make_composite</span><span class="p">(</span>
    <span class="n">obs_nc_path</span><span class="o">=</span><span class="s1">&#39;./data/HadCRUT.5.0.1.0.analysis.anomalies.ensemble_mean.nc&#39;</span><span class="p">,</span>
    <span class="n">vn</span><span class="o">=</span><span class="s1">&#39;tas_mean&#39;</span><span class="p">,</span>
    <span class="n">lat_name</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">lon_name</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
    <span class="n">bin_width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Analyzing ProxyRecord:  18%|█▊        | 9/49 [00:01&lt;00:07,  5.16it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord:  43%|████▎     | 21/49 [00:04&lt;00:05,  5.18it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord:  63%|██████▎   | 31/49 [00:06&lt;00:03,  5.03it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord:  65%|██████▌   | 32/49 [00:06&lt;00:03,  5.05it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord:  73%|███████▎  | 36/49 [00:07&lt;00:02,  5.12it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord:  88%|████████▊ | 43/49 [00:08&lt;00:01,  5.15it/s]/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/lib/function_base.py:495: RuntimeWarning: Mean of empty slice.
  avg = a.mean(axis)
/Users/fzhu/Apps/miniconda3/envs/cfr-env/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Analyzing ProxyRecord: 100%|██████████| 49/49 [00:09&lt;00:00,  5.11it/s]
Bootstrapping:   0%|          | 0/207 [00:00&lt;?, ?it/s]/Users/fzhu/Github/cfr/cfr/utils.py:127: RuntimeWarning: Mean of empty slice
  stats[i] = stat_func(samples[rand_ind])
Bootstrapping: 100%|██████████| 207/207 [00:03&lt;00:00, 67.77it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the composite infomation:</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;proxy_comp:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_ice</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;proxy_comp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;proxy_num:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_ice</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;proxy_num&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df_obs:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_ice</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;df_obs&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;slope:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_ice</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;intercept:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pdb_ice</span><span class="o">.</span><span class="n">composite</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
proxy_comp:
 Float64Index([ -45.0,  -35.0,  -25.0,  -15.0,   -5.0,    5.0,   15.0,   25.0,
                35.0,   45.0,
              ...
              1925.0, 1935.0, 1945.0, 1955.0, 1965.0, 1975.0, 1985.0, 1995.0,
              2005.0, 2015.0],
             dtype=&#39;float64&#39;, length=207)
proxy_num:
 [ 2.  2.  3.  3.  3. 18. 16. 13. 18. 14. 17. 16. 14. 18. 13. 18. 14. 16.
 17. 14. 19. 16. 18. 21. 17. 21. 16. 20. 22. 17. 22. 18. 20. 21. 18. 22.
 18. 19. 22. 18. 22. 17. 20. 22. 18. 22. 19. 19. 23. 19. 22. 21. 19. 23.
 20. 21. 21. 18. 23. 21. 24. 20. 22. 24. 19. 24. 22. 20. 24. 22. 22. 22.
 21. 22. 23. 25. 20. 23. 25. 20. 25. 23. 22. 27. 25. 24. 26. 25. 26. 26.
 28. 26. 24. 29. 27. 28. 28. 28. 28. 28. 29. 26. 28. 30. 26. 33. 31. 28.
 33. 31. 33. 29. 30. 33. 30. 31. 30. 31. 32. 30. 34. 31. 30. 34. 32. 34.
 29. 34. 37. 34. 38. 35. 34. 38. 36. 38. 36. 34. 38. 36. 38. 34. 36. 38.
 37. 37. 39. 39. 41. 39. 40. 40. 41. 42. 39. 43. 41. 41. 44. 40. 44. 42.
 41. 42. 43. 45. 43. 43. 45. 41. 45. 44. 45. 47. 45. 46. 46. 46. 48. 46.
 48. 46. 46. 48. 46. 48. 46. 46. 48. 46. 48. 46. 46. 47. 45. 47. 45. 43.
 45. 42. 44. 42. 41. 38. 31. 11.  2.]
df_obs:
          Ant_023   Ant_024   Asi_243   Ant_012   Ant_020   Arc_029   Arc_035  \
1855.0       NaN       NaN       NaN       NaN       NaN       NaN       NaN
1865.0       NaN       NaN       NaN       NaN       NaN       NaN       NaN
1875.0       NaN       NaN       NaN       NaN       NaN       NaN       NaN
1885.0       NaN       NaN  0.139995       NaN       NaN       NaN       NaN
1895.0       NaN       NaN -0.118933       NaN       NaN       NaN       NaN
1905.0       NaN       NaN -0.369459       NaN       NaN       NaN -0.603498
1915.0       NaN       NaN -0.175235       NaN       NaN       NaN -0.614646
1925.0       NaN       NaN -0.018831       NaN       NaN       NaN  0.086704
1935.0       NaN       NaN -0.057067       NaN       NaN  0.538414 -0.021455
1945.0       NaN       NaN  0.236839       NaN       NaN  0.776661  0.112016
1955.0       NaN       NaN  0.168506       NaN       NaN  0.521945  0.135299
1965.0 -0.313322 -0.253688 -0.196634 -0.292372 -0.292372 -0.137939  0.101147
1975.0 -0.048645  0.021360  0.050542 -0.048588 -0.048588 -0.119113 -0.159988
1985.0  0.250237  0.113763  0.159978  0.290649  0.290649  0.253296  0.086987
1995.0  0.113013 -0.020191  0.513645  0.224178  0.224178  0.953670  0.585728
2005.0  0.299738  0.400907  1.225578  0.383425  0.383425  1.852015  1.665739
2015.0  0.581113  0.715279  1.341981       NaN       NaN  3.126605  2.677361
2025.0  0.778325  1.112580  0.937778       NaN       NaN  3.614207  3.113754

         Ant_001   Ant_006   Ant_022  ...   Ant_017   Arc_072   Arc_005  \
1855.0       NaN       NaN       NaN  ...       NaN -0.280897       NaN
1865.0       NaN       NaN       NaN  ...       NaN -0.670608       NaN
1875.0       NaN       NaN       NaN  ...       NaN -0.585217       NaN
1885.0       NaN       NaN       NaN  ...       NaN -0.660067       NaN
1895.0       NaN       NaN       NaN  ...       NaN -0.562983       NaN
1905.0       NaN       NaN       NaN  ...       NaN -0.417878       NaN
1915.0       NaN       NaN       NaN  ...       NaN -1.320367       NaN
1925.0       NaN       NaN       NaN  ...       NaN  0.060131       NaN
1935.0       NaN       NaN       NaN  ...       NaN  0.981169  0.264023
1945.0       NaN       NaN       NaN  ...       NaN  0.236257  0.627976
1955.0       NaN       NaN       NaN  ...       NaN  0.802106  0.365638
1965.0 -0.267722 -0.292372 -0.267722  ... -0.278118 -0.407866 -0.090010
1975.0 -0.075961 -0.048588 -0.075961  ... -0.099375  0.204257 -0.116037
1985.0  0.228602  0.290649  0.228602  ...  0.254905  0.049942  0.205072
1995.0  0.067558  0.224178  0.067558  ...  0.233954  0.754574  0.925490
2005.0  0.158230  0.383425  0.158230  ...  0.343302  1.515841  1.965930
2015.0  0.323441       NaN  0.323441  ...       NaN  2.208421  3.132025
2025.0  0.494990       NaN  0.494990  ...       NaN  2.283274  3.490996

         Ant_019   Ant_014   Arc_018   Ant_025   Ant_004   Ant_021   Ant_026
1855.0       NaN       NaN -0.292929       NaN       NaN       NaN       NaN
1865.0       NaN       NaN -0.650675       NaN       NaN       NaN       NaN
1875.0       NaN       NaN -0.600465       NaN       NaN       NaN       NaN
1885.0       NaN       NaN -0.653229       NaN       NaN       NaN       NaN
1895.0       NaN       NaN -0.552476       NaN       NaN       NaN       NaN
1905.0       NaN       NaN -0.400410       NaN       NaN       NaN       NaN
1915.0       NaN       NaN -1.298685       NaN       NaN       NaN       NaN
1925.0       NaN       NaN  0.085491       NaN       NaN       NaN       NaN
1935.0       NaN       NaN  0.992762       NaN       NaN       NaN       NaN
1945.0       NaN       NaN  0.266806       NaN       NaN       NaN       NaN
1955.0       NaN       NaN  0.835667       NaN       NaN       NaN       NaN
1965.0 -0.298497 -0.385644 -0.436804 -0.312661 -0.352912 -0.298170 -0.379588
1975.0 -0.056960 -0.006243  0.231445 -0.049492 -0.018038  0.052657  0.015876
1985.0  0.276860  0.211112  0.051274  0.254946  0.203027  0.095440  0.139570
1995.0  0.165074 -0.073291  0.760437  0.137430  0.219234  0.015530 -0.135029
2005.0  0.334288  0.415313  1.557320  0.312354  0.203737  0.088824  0.516788
2015.0       NaN  0.428496  2.293309       NaN  0.279991  0.308260  0.388682
2025.0       NaN  1.066092  2.478646       NaN  0.496328  0.500786  1.201178

[18 rows x 49 columns]
slope:
 2.0593226894261307
intercept:
 -0.31291868333382383
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pdb_ice</span><span class="o">.</span><span class="n">plot_composite</span><span class="p">()</span>
<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">cfr</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;./figs/ice_composite.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_proxy-composites_24_0.png" src="../_images/notebooks_proxy-composites_24_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Figure saved at: &#34;figs/ice_composite.pdf&#34;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="proxy-get-nearest-climate.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Get the nearest climate for proxies</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../ug-climate.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Climate</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Feng Zhu<br/>
  
      &copy; Copyright 2022, Feng Zhu.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>